# 架构

## 后端

这部分在server文件夹内

### 部署google cloud

https://cloud.google.com/appengine/docs/standard/nodejs/runtime

### 主体框架[express](https://expressjs.com/en/guide/routing.html)

用来处理来自前端的URL请求，这个用npm安装

```shell
# 这部分在server文件夹内运行
npm init
npm install express --save
```

之后创建app.js文件作为后端API服务

### 数据库mongoose

#### 在服务器（google）上创建

#### 在express上链接

需要在npm上安装链接器（就是一堆用来管理链接的代码）方便用js语法链接mongoose数据库

```shell
npm install mongoose
```

#### 使用

```js
const mongoose = require('mongoose');

mongoose.connect('yourMongoDBConnectionString', { useNewUrlParser: true, useUnifiedTopology: true })
  .then(() => console.log('MongoDB connected'))
  .catch(err => console.log(err));
```

## 前端

这部分在web文件夹内

### 主体框架angular

用angular的语法生成html，不是直接写html界面

```shell
npm install -g @angular/cli
# 这部分在这个项目的根目录运行（会创建一个web子文件夹）
ng new web --minimal
cd web
# 尝试运行默认生成的项目
ng serve --open
```

#### 常用指令

```
# 创建组件
ng g c <component name>
# 创建服务
ng g s <service name>
```

### css式样ng-bootstrap

```shell
ng add @ng-bootstrap/ng-bootstrap
```

https://ng-bootstrap.github.io/#/home

### css样式angular/material

```shell
ng add @angular/material
```

https://material.angular.io/components/progress-spinner/overview

### 图表highcharts-angular

```shell
npm install highcharts highcharts-angular
```

https://www.npmjs.com/package/highcharts-angular

https://github.com/highcharts/highcharts-angular

### 分享链接

[twitter](https://developer.twitter.com/en/docs/twitter-for-websites/tweet-button/overview)
[facebook](https://developers.facebook.com/docs/plugins/share-button)

### icons

https://fontawesome.com/search
- https://icons.getbootstrap.com/icons/caret-up-ﬁll
- https://icons.getbootstrap.com/icons/caret-down-ﬁll
- https://icons.getbootstrap.com/icons/star
- https://icons.getbootstrap.com/icons/star-ﬁll
- https://icons.getbootstrap.com/icons/x
- https://fontawesome.com/icons/facebook-square?s=brands
- https://fontawesome.com/icons/twitter?s=brands

# API

## 搜索自动补全

搜索栏提示有哪些可能的股票选项

**The autocomplete response is filtered using the criteria: type= ‘Common Stock’, Symbol doesn’t contain ‘.’(dot)**

```
https://finnhub.io/api/v1/search?q=<COMPANY_NAME/SYMBOL>&token=<API_TOKEN>
```

## 详情界面

```
https://finnhub.io/api/v1/stock/profile2?symbol=VMW&token=cn83jf1r01qplv1ek8f0cn83jf1r01qplv1ek8fg
https://finnhub.io/api/v1/quote?symbol=VMW&token=cn83jf1r01qplv1ek8f0cn83jf1r01qplv1ek8fg
https://finnhub.io/api/v1/stock/peers?symbol=VMW&token=cn83jf1r01qplv1ek8f0cn83jf1r01qplv1ek8fg

{"country":"US","currency":"USD","estimateCurrency":"USD","exchange":"NEW YORK STOCK EXCHANGE, INC.","finnhubIndustry":"Technology","ipo":"2007-08-14","logo":"https://static2.finnhub.io/file/publicdatany/finnhubimage/stock_logo/VMW.svg","marketCapitalization":61521.364654,"name":"VMware Inc","phone":"16504275000.0","shareOutstanding":431.79,"ticker":"VMW","weburl":"https://www.vmware.com/"}
{"c":0,"d":null,"dp":null,"h":0,"l":0,"o":0,"pc":0,"t":0}
["MSFT","ORCL","NOW","PANW","CRWD","VMW","FTNT","ZS","GEN","PATH"]
```



重要提示：**所有数值应四舍五入到小数点后2位。**

**股票详细信息部分和摘要选项卡中提到的数据应在股市开放时每15秒自动更新一次**

### 图表

```shell
  https://api.polygon.io/v2/aggs/ticker/AAPL/range/60/minute/2024-03-19/2024-03-20?adjusted=true&sort=asc&apiKey=Rs6kySvg5Yir8e50SPLKAYW9gZXV7Ovr
  
  {"ticker":"AAPL","queryCount":735,"resultsCount":16,"adjusted":true,"results":[{"v":24291,"vw":173.883,"o":173.9,"c":174.1,"h":174.38,"l":173.32,"t":1710835200000,"n":900},{"v":16179,"vw":174.0559,"o":174.15,"c":173.86,"h":174.2,"l":173.74,"t":1710838800000,"n":491},{"v":71137,"vw":175.9714,"o":175.76,"c":175.72,"h":176.08,"l":175.6501,"t":1710882000000,"n":732},{"v":34704,"vw":175.7095,"o":175.72,"c":175.6,"h":175.87,"l":175.6,"t":1710885600000,"n":764},{"v":49972,"vw":175.5568,"o":175.78,"c":175.65,"h":175.78,"l":175.4,"t":1710889200000,"n":948}],"status":"DELAYED","request_id":"4020b3513eeb64ec708977aa4c3a4add","count":16}
```

## 图表界面

```shell
```



# 注意重点

## 路由导航

主页路由['/']重定向到['/search/home']-这是此应用程序的默认路由。

B）搜索详细信息路线['/search/<ticker>']-它显示搜索的<ticker>的详细信息

C）监视列表路由['/watchlist']-它显示用户的监视列表。

D）投资组合路线['/portfolio']-它显示用户的投资组合。

用户执行搜索股票代码后，页面应路由到/search/<ticker>路径（例如：/search/AMZN）。成功搜索时需要显示以下组件

重要提示：如果用户导航到watchlist或portfolio，并导航回search页面，则之前搜索的股票结果应保留在搜索/<ticker>路由上。此外，结果数据应从状态/服务中检索，而不是从新的搜索API调用中获取。